<project name="flashlight" default="instrument">
	<!-- Set these two variables -->
	<property name="eclipse-workspace" value="c:/work/sierra-test-workspace" />
	<!-- This should be where you unzipped this ant script -->
	<property name="flashlight-ant" value="../flashlight-ant/flashlight-ant" />

	<!--property name="data-directory" value="${eclipse-workspace}/.flashlight-data" /-->
	<property name="data-directory" value="${eclipse-workspace}/fl-data" />

	<taskdef resource="com/surelogic/flashlight/ant/antlib.xml">
		<classpath>
			<pathelement path="${flashlight-ant}/flashlight-ant.jar" />
			<pathelement path="${flashlight-ant}/flashlight-rewriter.jar" />
			<pathelement path="${flashlight-ant}/derby.jar" />
			<pathelement path="${flashlight-ant}/asm-3.2.jar" />
			<pathelement path="${flashlight-ant}/asm-commons-3.2.jar" />
		</classpath>
	</taskdef>

	<property name="flashlight-runtime.jar" value="${flashlight-ant}/flashlight-runtime.jar" />

	<target name="instrument">
		<!-- Set the src and dest for the war that Maven creates -->
		<!-- 			                collectiontype="ONLY_LOCKS" -->
		<instrument-archive srcfile="./jetty/sl.orig.war" 
			                destfile="./jetty/webapps/sl.war" 
			                runtime="${flashlight-runtime.jar}" 
			                datadir="${data-directory}"
			                properties="./fl.properties">
			<libs>
				<!-- Set these based on whatever web container you're using -->
				<pathelement location="./jetty/lib/servlet-api-2.5-6.1.7.jar" />
				<pathelement location="./jetty/lib/jetty-6.1.7.jar" />
				<pathelement location="./jetty/lib/jetty-util-6.1.7.jar" />
			</libs>
		</instrument-archive>
	</target>
</project>